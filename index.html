<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="style.css" />
    <title>CSS Clock</title>
  </head>
  <body>
    <div class="clock"></div>
    <div class="marker-hour-1 marker"></div>
    <div class="marker-hour-2 marker"></div>
    <div class="marker-hour-3 marker-quarter"></div>
    <div class="marker-hour-4 marker"></div>
    <div class="marker-hour-5 marker"></div>
    <div class="marker-hour-6 marker-quarter"></div>
    <div class="marker-hour-7 marker"></div>
    <div class="marker-hour-8 marker"></div>
    <div class="marker-hour-9 marker-quarter"></div>
    <div class="marker-hour-10 marker"></div>
    <div class="marker-hour-11 marker"></div>
    <div class="marker-hour-12 marker-quarter"></div>

    <div class="marker-min-1 marker-min"></div>
    <div class="marker-min-2 marker-min"></div>
    <div class="marker-min-3 marker-min"></div>
    <div class="marker-min-4 marker-min"></div>
    <div class="marker-min-6 marker-min"></div>
    <div class="marker-min-7 marker-min"></div>
    <div class="marker-min-8 marker-min"></div>
    <div class="marker-min-9 marker-min"></div>
    <div class="marker-min-11 marker-min"></div>
    <div class="marker-min-12 marker-min"></div>
    <div class="marker-min-13 marker-min"></div>
    <div class="marker-min-14 marker-min"></div>
    <div class="marker-min-16 marker-min"></div>
    <div class="marker-min-17 marker-min"></div>
    <div class="marker-min-18 marker-min"></div>
    <div class="marker-min-19 marker-min"></div>
    <div class="marker-min-21 marker-min"></div>
    <div class="marker-min-22 marker-min"></div>
    <div class="marker-min-23 marker-min"></div>
    <div class="marker-min-24 marker-min"></div>
    <div class="marker-min-26 marker-min"></div>
    <div class="marker-min-27 marker-min"></div>
    <div class="marker-min-28 marker-min"></div>
    <div class="marker-min-29 marker-min"></div>
    <div class="marker-min-31 marker-min"></div>
    <div class="marker-min-32 marker-min"></div>
    <div class="marker-min-33 marker-min"></div>
    <div class="marker-min-34 marker-min"></div>
    <div class="marker-min-36 marker-min"></div>
    <div class="marker-min-37 marker-min"></div>
    <div class="marker-min-38 marker-min"></div>
    <div class="marker-min-39 marker-min"></div>
    <div class="marker-min-41 marker-min"></div>
    <div class="marker-min-42 marker-min"></div>
    <div class="marker-min-43 marker-min"></div>
    <div class="marker-min-44 marker-min"></div>
    <div class="marker-min-46 marker-min"></div>
    <div class="marker-min-47 marker-min"></div>
    <div class="marker-min-48 marker-min"></div>
    <div class="marker-min-49 marker-min"></div>
    <div class="marker-min-51 marker-min"></div>
    <div class="marker-min-52 marker-min"></div>
    <div class="marker-min-53 marker-min"></div>
    <div class="marker-min-54 marker-min"></div>
    <div class="marker-min-56 marker-min"></div>
    <div class="marker-min-57 marker-min"></div>
    <div class="marker-min-58 marker-min"></div>
    <div class="marker-min-59 marker-min"></div>

    <div class="number-1 number">1</div>
    <div class="number-2 number">2</div>
    <div class="number-3 number-big">3</div>
    <div class="number-4 number">4</div>
    <div class="number-5 number">5</div>
    <div class="number-6 number-big">6</div>
    <div class="number-7 number">7</div>
    <div class="number-8 number">8</div>
    <div class="number-9 number-big">9</div>
    <div class="number-10 number">10</div>
    <div class="number-11 number">11</div>
    <div class="number-12 number-big">12</div>

    <div class="dot"></div>
    <div id="second"></div>
    <div id="minute"></div>
    <div id="hour"></div>

    <script>
      let oldDate = new Date('1970-01-01T00:00:00')

      function reset_animation(element) {
        var el = document.getElementById(element)
        el.style.animation = 'none'
        el.offsetHeight /* trigger reflow */
        el.style.animation = null
      }

      function clockAnimated() {
        let date = new Date()

        const element = document.querySelector('body')

        let hours, minutes, seconds, oldHours, oldMinutes, oldSeconds

        oldHours = oldDate.getHours()
        oldMinutes = oldDate.getMinutes()
        oldSeconds = oldDate.getSeconds()

        hours = date.getHours()
        minutes = date.getMinutes()
        seconds = date.getSeconds()

        // animation from 23 to 0 runs backwards so we have to handle this
        if (oldHours > hours) {
          hours = oldHours + 1
        }

        // animation from 59 to 0 runs backwards so we have to handle this
        if (oldMinutes > minutes) {
          minutes = oldMinutes + 1
        }

        // animation from 59 to 0 runs backwards so we have to handle this
        if (oldSeconds > seconds) {
          seconds = oldSeconds + 1
        }

        element.style.setProperty('--hour', hours)
        element.style.setProperty('--minute', minutes)
        element.style.setProperty('--second', seconds)
        element.style.setProperty('--hour-before', oldHours)
        element.style.setProperty('--minute-before', oldMinutes)
        element.style.setProperty('--second-before', oldSeconds)

        reset_animation('second')
        reset_animation('minute')
        reset_animation('hour')

        oldDate = new Date()
      }

      window.addEventListener('load', () => {
        window.setInterval(function() {
          clockAnimated()
        }, 1000)
      })
    </script>
  </body>
</html>
